+++
title = "概率论的解释：《概率论沉思录》笔记"
description = "概率论的正确直观解释。回答：概率论对现实的描述何以可能指导现实活动？概率论能多大程度地描述现实？"
date = 2025-04-12
updated = 2025-09-04

[extra]
math = true
toc = true

[extra.sitemap]
priority = "0.8"

[taxonomies]
categories = ["知识"]
tags = ["笔记", "数学", "概率论", "统计学", "含模拟", "在线"]
+++

前置知识
- 一般的概率论基础

参考阅读
- 《概率论及其应用》，译自 William Feller 所作的经典 *An Introduction to Probability Theory and Its Application*
- 《概率论沉思录》

## 说明 {#about}
在概率论（和统计）中有频率学派（Frequentist）和贝叶斯学派（Bayesian）两大流派。后者引入了先验概率和后验概率的概念，在人工智能时代获得了更多的支持。《概率论沉思录》一书的作者采取了更广阔的视角，试图解决直觉相互矛盾的问题，以及揭示先验信息的巨大影响。

本文旨在探讨两个问题：
- 概率论对现实的描述何以可能指导现实活动？
    - 统计出的、计算出的概率为何合理？
    - 提出合理的假设何以可能？
- 概率论能多大程度地描述现实？
    - 当我们掷一个骰子时，我们何时把它看作每面 1/6 概率朝下而忽略材质的不均匀、抛掷的手法、空气的流动？
    - 我们应如何掌握这种判断的“把握”？

以及系统性地解决下面两个例子之类的佯谬。

### 三门问题
一个典型的直觉相互矛盾的问题是三门问题，最早在美国电视节目 Let's Make a Deal 中由主持人 Monty Hall 推广。

参赛者需从三扇门中选择一扇，背后可能是汽车（大奖）或山羊（安慰奖）。然后，主持人会打开一扇未被选择且藏有山羊的门，问参赛者是否要坚持原选择还是换门。

该问题以各种途径传播，引起了极大的争议。

[我们来做一次模拟。](/playground/simulation_three_door.html)

{% shell(text = "关于模拟的配置说明。") %}
随机源只支持默认随机源 `Math.random()`，其使用系统熵源，随机算法取决于具体实现，如 [xorshift128+](https://github.com/v8/v8/blob/master/src/base/utils/random-number-generator.cc)，`pcg32` 及 `arc4random_buf`

两个方案中，方案一是：虚拟主持人一开始就知晓门的对应，依此选择开哪个门；方案二是：虚拟主持人一开始不知道门的对应，随机从未选的门挑，根据情况决定。
{% end %}

通过上述观察模拟（或计算），可以发现换门则胜利频率为 $\frac{2}{3}$，否则为 $\frac{1}{3}$.

但是，存在一些基于直觉的不同意见：
- 打开门什么都不会影响，因此不合理。
- 主持人的行为是存在约束的（即必须打开无车门），这在初始选对、选错时概率不一样，因此结果是合理的。
- 换和不换同样是在两个门中选择，因此不合理。
- 可以理解为：把两个门合并成一个，因此结果是合理的。

### Bertrand 悖论
Bertrand 悖论提出的问题是：在单位圆内任意画一条弦，弦长超过 $\sqrt{3}$ 的概率是多少？

存在以下不同的答案
1. 先固定一点，再取另一点。结果为 $\frac{1}{3}$
2. 先固定弦的斜率，考察弦中点的位置。结果为 $\frac{1}{2}$
3. 直接考察弦中点的位置，只能在一个小圆内。结果为 $\frac{1}{4}$

## 讨论的可能
### 必要的认可
第一个问题涉及了一个更基本的问题——认识论的问题。认识论不在本文讨论范围内。我们不希望陷入这样的问题：
- 使用的逻辑体系是否一定正确？
- 在推导过程中有多大的可能出错，而没有人发现？
- 我是真的理解了这些内容，还是我恰好产生了对它们的自信？

因此，希望读者认可：以某种方式，以概率论对现实的描述指导现实活动是可能的。为此，你或许可以采取以下选择：
- 盲信。时代、文化的变化已经塑造了（大部分时候）足以应对生活的直观认识。
    > 人类的集体直观能力也在进步着 … 同样，现在的学生不会体会到，当概率论还在萌芽的时候，它与某些思维方式、偏见及其他困难的斗争情形。
- 实用主义。概率论是一个（从经验上看/从权威上看/从自己对数学推导的认可上看）好用的模型。
    > 我们所关心的不是归纳推理的形态，而是一种可以叫作是*物理概率*或者*统计概率*的事物 … 我们所说的判断不是关于这些的判断，而是关于一个*理想实验*的可能结果 … 大家必须先承认一个特殊理想实验的想象模型。
- 其它可能的论证。如果你对形而上内容的了解可以支撑。

### 理想化
进行理想化是有必要的。
> 测定原子的寿命或人的寿命而没有误差是不可能的，但是为了理论上的目的，我们不妨设想寿命是实实在在的一个数，这样问题就产生了 …… 另一方面，现行的保险业务对于人的可能寿命却不加任何上限，按照寿险死亡率表所基于的公式算出来，千年不死的人在全人类中大约只占 $10^{10^{36}}$ 分之一 …… 使用这种小概率非但没有坏处，而且还可以简化公式，再说，如果我们真地把活一千年的可能性排除掉，我们势必承认一个最大年龄限 $x$ 的存在，说人能活 $x$ 年而不能活 $x$ 年零两秒，这种说法决不会比无限寿命的说法更能讲得通些。

我们将从有限的、理想化的模型开始，之后再考察无限的及不那么理想化的情形。

## 规则的构建
### 合情推理原则
假定需要开发一个推理机器人，对合情程度进行推理。我们希望满足如下条件：
1. 用实数表示合情程度。从直觉上说，我们需要全序和连续性。
2. 定性地与常识相符。例如说我们希望可以构成（广义的）布尔代数。
3. 推理是一致的。也就是：
    1. 不同的推理方式结果一致
    2. 会考虑的是所有有关的证据
    3. 在相同的情形下合情程度相同

### 定量规则
接下来推导出一些定量的规则：
1. 乘法规则。\
我们希望决定 $A\wedge B$ 为真有两种途径：先决定其一，在接受它的条件下接受另一个。从合情推理原则 3.2 我们可以得出 $(C\implies A\wedge B) = F((C\implies B), (B\wedge C\implies A))$，同样地对 $(D\implies A\wedge B\wedge C)$ 使用合情推理原则 3.1 可推出 $F(F(x, y), z) = F(x, F(y, z))$；此外，$F$ 应当是连续且单调的。
Aczél 在他的函数方程著作中用 11 页推导出了方程的一般解。如果我们进一步要求可微性，则证明可缩短。解被表示为 $F(x, y) = \omega^{-1}(\omega(x)\omega(y))$

2. 值域。\
由乘法规则得出，确定性由 $\omega(Q) = 1$ 表示，进一步**约定** $0 \leq \omega(Q) \leq 1$

3. 加法规则。\
考虑那些非真即假的命题，$A\wedge \bar{A}$ 总是假的。通过分析得到 $\exists m>0, \omega^m(B\implies A)+\omega^m(B\implies \bar{A})$，使用代替 $p(x)\equiv\omega^m(x)$ 是符合值域条件的，没有丧失一般性。

4. 广义加法规则。\
由加法规则可进一步推导出 $p(C\implies A\vee B) = p(C\implies A) + p(C\implies B) - p(C\implies A\wedge B)$

### 填入数值
下面将使用更简单的符号，用 $P|Q$ 表示 $Q\implies P$，用 $P+Q$ 表示 $P\vee Q$，用 $PQ$ 表示 $P\wedge Q$

实际上，我们的事实可以形如 $C\equiv (A\implies B)$，这同样可被恰当地赋值符合我们的体系。

我们假设 $B\equiv \left(p(A_iA_j | B) = p(A_i | B)\delta_{i, j}\right)$，其中 $\delta$ 是 Kronecker 符号。则有 $\sum_{i=1}^n p(A_i|B) = 1$，我们需要做的是将信息转换为 $p(A_i|B)$ 的值。

如果这些 $A_i$ 在交换后没有任何区别，**为了满足合情推理原则 3.3，唯一的结果**是 $p(A_i|B)=\frac{1}{n}$，我们称为**无差别原则**。

需要注意这来自于合情推理原则。

从现在开始，我们称那些量 $p$ 为**概率**，在参数是命题时，使用大写字母 $P$。

考察这样一个问题：
{% admonition(type="question", title="Pólya 坛子模型") %}
一个坛子中有 3 个黑球，7 个白球，它们具有相同的大小和重量。摇动坛子并随机抽取一个球，取出一个黑球的概率是多少？
{% end %}

这个问题联系了现实。我们需要对题目条件进行理想化。
> 硬币掉下时不一定是正面朝上或反面朝上，它可能是滚掉了，也可能是笔直地站着，但是我们只承认正面和反面是扔硬币以后仅有的可能结果，这样一来，理论要简洁得多了，同时也不影响其应用，这种类型的理想化是实践中标准的处理办法。

类似地，在此问题中，我们只考虑十种互斥的取出球的情况，并且出于无差别原则，它们分配的概率都是 $\frac{1}{10}$

由此，取到黑球的概率是 $\frac{3}{10}$

对于现实问题，例如“摸到黑球”，我们可以将其分解为“今天在下雨并且摸到了黑球”和“今天不在下雨并且摸到了黑球”，但是这就成为了“空洞的形式化练习”。我们应当把 $AB$ 视作两者都为真的陈述，$P(AB|C)$ 是一个基本量，不一定可解析为更基本的量（尽管可以用于计算）。

### Kolmogorov 公理
Kolmogorov 提出了一种用集合论（和测度论）语言表达概率论的方法。

回顾 Kolmogorov 的公理化定义：

给定集合 $\Omega$，如果 $\mathfrak{F}\subset 2^\Omega$ 满足：
1. $\Omega\in\mathfrak{F}$
2. 取逆封闭：若 $A\in\mathfrak{F}$ 则

$$\bar{A}\in\mathfrak{F}$$

3. 可列并封闭：若 $\\{A_n\\}_{n\geq 1}\subset \mathfrak{F}$ 则

$$\bigcup\limits_{n=1}^{+\infty} A_n\in\mathfrak{F}$$

则称 $\mathfrak{F}$ 为 $\Omega$ 上的 σ-代数。

$\mathfrak{F}$ 上的概率 $P: 2^\Omega\to \mathbb{R}$ 满足
1. 非负：$P(A)\geq 0$
2. 规范性：$P(\Omega)=1$
3. 可列可加性：对 $\\{A_n\\}_{n\geq 1}$ 两两不交

$$P(\bigcup\limits_{n=1}^{+\infty} A_n) = \sum_{n=1}^{+\infty} P(A_n)$$

我们在技术上支持此，但不局限于集合。

## 初等抽样论
### 无放回抽样
由于信息的不完全性，我们暂且不能假设分配的概率与实验事实间的关系。

{% admonition(type="abstract", title="重新考虑 Pólya 坛子模型") %}
$B\equiv$ 一个坛子中有 $M$ 个红球，$N-M$ 个白球，每次从中随机抽取一个球，记录其颜色并放在一边；重复 $n\leq N$ 次

$R_i\equiv$ 第 $i$ 次取出红球

$W_i\equiv$ 第 $i$ 次取出白球
{% end %}

在取出球后，推理机器的知识状态就会发生变化。

容易推得，共取出 $r\leq n$ 个红球的概率为 $h(r) = \frac{\begin{pmatrix} M\\\\ r \end{pmatrix}\begin{pmatrix} N-M\\\\ n-r \end{pmatrix}}{\begin{pmatrix} N\\\\ n \end{pmatrix}}$，称为**超几何分布**。

或许会有一些“反因果”的事情在其中发生。如果机器预先知道第二次抽取会取出红球，那么第一次抽取时的概率就会不同（如若 $M=1$ 则第一次不可能抽到红球）。我们不应该认为逻辑的 $\implies$ 与物理的因果一定有关。

如果一个概率分布中，概率只取决于单次试验的结果的出现次数，则称它是**可交换的**。超几何分布是可交换的，这从物理因果角度无法解释。

而从逻辑推导可以算出 $P(R_k|R_jB) = \frac{M-1}{N-1}, P(R_k|W_jB) = \frac{M}{N-1}$，等同于“搁置”了一个红/白球到后面。

如果机器预先知道的是“后面至少会抽取出一个红球”，但不知道是哪一次，结果是一样的。

读者也可以自行尝试解释 Fisher-Yates 算法。

---

现在研究超几何分布的极限形式。即确定 $f = \frac{M}{N}$ 并让 $n\to \infty$

我们有 $h(r) = \begin{pmatrix} n\\\\ r \end{pmatrix} f^r(1-f)^{n-r}$，称为**二项分布**。

广义超几何分布（有多种颜色的球）在极限情形下会变成多项分布。

### 相关性校正
在现实中摇动坛子的过程，我们称为“随机化”，目的是让信息更加复杂，并且因信息过于复杂而故意丢弃。

但随机化并不会让等式变得精确，可以直接应用于现实。我们将看到，小的误差会被积累。

例如说，我们假设抽取并放回一个红球会略微增加下一次抽到红球的概率，反之亦然，也就是 $P(R_k|R_{k-1}C) = \frac{M}{N}+\epsilon, P(R_k|W_{k-1}C) = \frac{M}{N}-\delta$

通过使用矩阵对角化，可以算得 $P(R_k|C) = \frac{(p-\delta)-(\epsilon+\delta)^{k-1}(p\epsilon-q\delta)}{1-\epsilon-\delta}, p=\frac{M}{N}, q=1-p$

## 初等假设检验
### 定义
康德引入了先验一词来表示独立于经验而可以知道真假的命题。但先验概率一词在今天看来是不合适的。

如何将字面上的先验信息转换为数值先验是一个开放的问题，我们将在之后讨论。

令 X 为先验信息，H 为待检验的假设，D 为数据，有 $P(H|DX)=P(H|X)\frac{P(D|HX)}{P(D|X)}$，等式左侧为**后验概率**，最后一项为**似然** $L(H)$

为了变得*无量纲*，定义**几率**是指 $O(H|DX)=\frac{P(H|DX)}{P(\bar{H}|DX)}$

我们再定义**证据**是指 $e(H|DX)=10\log_{10} O(H|DX)$，单位为 dB，这符合 Weber-Fechner 定律指出的感知的强度与物理强度的对数有关。

如果 $P(D_2|D_1HX) = P(D_2|HX)$ 我们说 $D_1$ 与 $D_2$ 是**独立**的，独立并非是物理上的，而是逻辑上推理机器分配的概率。

{{ todo() }}

## 信念
### 信念强度
I. J. Good 说明了如何逆向使用概率论来测量我们的信念。

如果一个人总是能猜出你背着他写下的数，我们是否会因此考虑他可能有特异功能呢？

对于数字范围 1~10，也许在他猜对 10 个数后我们会考虑这种可能。那就是说，初始的信念程度大约为 -100dB

不过，即使他连着猜对了 1000 个，我们也不一定会采取这个假设。因为几乎一定有其它假设的可能性更高，比如 -60dB

拉普拉斯在《关于概率的哲学论文》中提到了这种现象，即：要人们承认自然法则失效，必须提供海量证据。

### 意见的趋同和分歧
{{ todo() }}

## 初等参数估计
{{ todo() }}

## 正态分布
### 来源
许多分布会趋近于 $\varphi(x) = \frac{1}{\sqrt{2\pi}}\exp (-\frac{x^2}{2})$，我们称为中心/高斯/正态分布。

$$
\left(\int e^{-\frac{t^2}{2}} \rm{d}t \right) =
\iint e^{-\frac{x^2+y^2}{2}} \rm{d}x\rm{d}y \overset{(x, y)\to(r, \theta)}{=}
\iint e^{-\frac{r^2}{2}} \rm{d}r\rm{d}\theta
$$

定义累积高斯分布 $\Phi(x)=\int_{-\infty}^x \varphi(t) \rm{d}t$

John Herschel 研究恒星位置出现误差的二维概率分布时导出了高斯分布，基于假设
* 正交方向上的误差概率独立
* 概率与角度无关

### 性质
{{ todo() }}

### 中心极限定理
{{ todo() }}
